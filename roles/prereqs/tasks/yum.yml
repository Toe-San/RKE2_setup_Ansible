---

# Does the Rancher RKE2 Common repo exist already
- name: Check to see if rke2-common.repo exists
  stat:
    path: '/etc/yum.repos.d/rke2-common.repo'
  register: stat_rke2_common

# Add RKE2 Common repo if it doesn't exist
- name: add the rke2-common repo
  yum_repository:
    name: rke2-common
    description: Rancher RKE2 Common Latest
    baseurl: "{{ rke2_repo_common_baseurl }}"
    gpgcheck: "{{ rke2_repo_common_gpg_check }}"
    gpgkey: "{{ rke2_repo_common_gpg_key }}"
    enabled: yes
  when: not stat_rke2_common.stat.exists

# Does the Rancher RKE2 1.19 repo exist already
- name: Check to see if rke2 versioned repo exists
  stat:
    path: '/etc/yum.repos.d/rke2-v{{rke_version}}.repo'  # noqa var-spacing
  register: stat_rke2_versioned_repo

# Add RKE2 1.19 repo if it doesn't exist
- name: add the rke2 versioned repo
  yum_repository:
    name: rke2-v1.19
    description: Rancher RKE2 1.19 Latest
    baseurl: "{{ rke2_repo_package_baseurl }}"
    gpgcheck: "{{ rke2_repo_package_gpg_check }}"
    gpgkey: "{{ rke2_repo_package_gpg_key }}"
    enabled: yes
  when: not stat_rke2_versioned_repo.stat.exists
